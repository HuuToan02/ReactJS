{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Toan/Desktop/reactjs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/Toan/Desktop/reactjs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"C:/Users/Toan/Desktop/reactjs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/Toan/Desktop/reactjs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useRef,useEffect}from\"react\";import{useFrame}from\"@react-three/fiber\";import create from\"zustand\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var BOX_COUNT=120;var boxIds=new Array(BOX_COUNT).fill().map(function(_,idx){return idx;});var boxIdsCoordinates=boxIds.reduce(function(acc,id){return _objectSpread(_objectSpread({},acc),{},_defineProperty({},id,[Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI]));},0);export var useStore=create(function(set){return{boxes:boxIds,coordinates:boxIdsCoordinates,mutate:function mutate(){set(function(state){var coordinates={};for(var i=0;i<state.boxes.length;i++){var id=state.boxes[i];var _state$coordinates$id=_slicedToArray(state.coordinates[id],3),x=_state$coordinates$id[0],y=_state$coordinates$id[1],z=_state$coordinates$id[2];coordinates[id]=[x+0.01,y+0.01,z+0.01];}return _objectSpread(_objectSpread({},state),{},{coordinates:coordinates});});}};});export function Box(_ref){var id=_ref.id;var mesh=useRef();var coordinates=useRef([0,0,0]);useEffect(function(){return useStore.subscribe(function(xyz){return coordinates.current=xyz;},function(state){return state.coordinates[id];});});useFrame(function(){var _mesh$current$rotatio;return mesh.current&&(_mesh$current$rotatio=mesh.current.rotation).set.apply(_mesh$current$rotatio,_toConsumableArray(coordinates.current));});return/*#__PURE__*/_jsxs(\"mesh\",{ref:mesh,children:[/*#__PURE__*/_jsx(\"boxBufferGeometry\",{args:[2,2,2],attach:\"geometry\"}),/*#__PURE__*/_jsx(\"meshNormalMaterial\",{attach:\"material\"})]});}","map":{"version":3,"sources":["C:/Users/Toan/Desktop/reactjs/src/components/pages/Box.js"],"names":["React","useRef","useEffect","useFrame","create","BOX_COUNT","boxIds","Array","fill","map","_","idx","boxIdsCoordinates","reduce","acc","id","Math","random","PI","useStore","set","boxes","coordinates","mutate","state","i","length","x","y","z","Box","mesh","subscribe","xyz","current","rotation"],"mappings":"ylBAAA,MAAOA,CAAAA,KAAP,EAAgBC,MAAhB,CAAwBC,SAAxB,KAAyC,OAAzC,CACA,OAASC,QAAT,KAAyB,oBAAzB,CACA,MAAOC,CAAAA,MAAP,KAAmB,SAAnB,C,wFAEA,GAAMC,CAAAA,SAAS,CAAG,GAAlB,CAEA,GAAMC,CAAAA,MAAM,CAAG,GAAIC,CAAAA,KAAJ,CAAUF,SAAV,EAAqBG,IAArB,GAA4BC,GAA5B,CAAgC,SAACC,CAAD,CAAIC,GAAJ,QAAYA,CAAAA,GAAZ,EAAhC,CAAf,CACA,GAAMC,CAAAA,iBAAiB,CAAGN,MAAM,CAACO,MAAP,CACxB,SAACC,GAAD,CAAMC,EAAN,wCACKD,GADL,wBAEGC,EAFH,CAEQ,CACJC,IAAI,CAACC,MAAL,GAAgBD,IAAI,CAACE,EADjB,CAEJF,IAAI,CAACC,MAAL,GAAgBD,IAAI,CAACE,EAFjB,CAGJF,IAAI,CAACC,MAAL,GAAgBD,IAAI,CAACE,EAHjB,CAFR,IADwB,CASxB,CATwB,CAA1B,CAYA,MAAO,IAAMC,CAAAA,QAAQ,CAAGf,MAAM,CAAC,SAACgB,GAAD,QAAU,CACvCC,KAAK,CAAEf,MADgC,CAEvCgB,WAAW,CAAEV,iBAF0B,CAGvCW,MAAM,CAAE,iBAAM,CACZH,GAAG,CAAC,SAACI,KAAD,CAAW,CACb,GAAMF,CAAAA,WAAW,CAAG,EAApB,CACA,IAAK,GAAIG,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGD,KAAK,CAACH,KAAN,CAAYK,MAAhC,CAAwCD,CAAC,EAAzC,CAA6C,CAC3C,GAAMV,CAAAA,EAAE,CAAGS,KAAK,CAACH,KAAN,CAAYI,CAAZ,CAAX,CACA,yCAAkBD,KAAK,CAACF,WAAN,CAAkBP,EAAlB,CAAlB,IAAOY,CAAP,0BAAUC,CAAV,0BAAaC,CAAb,0BACAP,WAAW,CAACP,EAAD,CAAX,CAAkB,CAACY,CAAC,CAAG,IAAL,CAAWC,CAAC,CAAG,IAAf,CAAqBC,CAAC,CAAG,IAAzB,CAAlB,CACD,CACD,sCAAYL,KAAZ,MAAmBF,WAAW,CAAXA,WAAnB,GACD,CARE,CAAH,CASD,CAbsC,CAAV,EAAD,CAAvB,CAgBP,MAAO,SAASQ,CAAAA,GAAT,MAAqB,IAANf,CAAAA,EAAM,MAANA,EAAM,CAC1B,GAAMgB,CAAAA,IAAI,CAAG9B,MAAM,EAAnB,CACA,GAAMqB,CAAAA,WAAW,CAAGrB,MAAM,CAAC,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CAAD,CAA1B,CACAC,SAAS,CAAC,iBACRiB,CAAAA,QAAQ,CAACa,SAAT,CACE,SAACC,GAAD,QAAUX,CAAAA,WAAW,CAACY,OAAZ,CAAsBD,GAAhC,EADF,CAEE,SAACT,KAAD,QAAWA,CAAAA,KAAK,CAACF,WAAN,CAAkBP,EAAlB,CAAX,EAFF,CADQ,EAAD,CAAT,CAMAZ,QAAQ,CACN,2CAAM4B,CAAAA,IAAI,CAACG,OAAL,EAAgB,uBAAAH,IAAI,CAACG,OAAL,CAAaC,QAAb,EAAsBf,GAAtB,gDAA6BE,WAAW,CAACY,OAAzC,EAAtB,EADM,CAAR,CAGA,mBACE,cAAM,GAAG,CAAEH,IAAX,wBACE,0BAAmB,IAAI,CAAE,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CAAzB,CAAoC,MAAM,CAAC,UAA3C,EADF,cAEE,2BAAoB,MAAM,CAAC,UAA3B,EAFF,GADF,CAMD","sourcesContent":["import React, { useRef, useEffect } from \"react\";\r\nimport { useFrame } from \"@react-three/fiber\";\r\nimport create from \"zustand\";\r\n\r\nconst BOX_COUNT = 120;\r\n\r\nconst boxIds = new Array(BOX_COUNT).fill().map((_, idx) => idx);\r\nconst boxIdsCoordinates = boxIds.reduce(\r\n  (acc, id) => ({\r\n    ...acc,\r\n    [id]: [\r\n      Math.random() * Math.PI,\r\n      Math.random() * Math.PI,\r\n      Math.random() * Math.PI,\r\n    ],\r\n  }),\r\n  0\r\n);\r\n\r\nexport const useStore = create((set) => ({\r\n  boxes: boxIds,\r\n  coordinates: boxIdsCoordinates,\r\n  mutate: () => {\r\n    set((state) => {\r\n      const coordinates = {};\r\n      for (let i = 0; i < state.boxes.length; i++) {\r\n        const id = state.boxes[i];\r\n        const [x, y, z] = state.coordinates[id];\r\n        coordinates[id] = [x + 0.01, y + 0.01, z + 0.01];\r\n      }\r\n      return { ...state, coordinates };\r\n    });\r\n  },\r\n}));\r\n\r\nexport function Box({ id }) {\r\n  const mesh = useRef();\r\n  const coordinates = useRef([0, 0, 0]);\r\n  useEffect(() =>\r\n    useStore.subscribe(\r\n      (xyz) => (coordinates.current = xyz),\r\n      (state) => state.coordinates[id]\r\n    )\r\n  );\r\n  useFrame(\r\n    () => mesh.current && mesh.current.rotation.set(...coordinates.current)\r\n  );\r\n  return (\r\n    <mesh ref={mesh}>\r\n      <boxBufferGeometry args={[2, 2, 2]} attach=\"geometry\" />\r\n      <meshNormalMaterial attach=\"material\" />\r\n    </mesh>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}